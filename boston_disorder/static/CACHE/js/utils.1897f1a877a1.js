// Generated by CoffeeScript 1.4.0
(function() {
  var changeType, insertParam;

  insertParam = function(key, value) {
    var i, kvp, x;
    key = escape(key);
    value = escape(value);
    kvp = document.location.search.substr(1).split('&');
    i = kvp.length;
    x;

    while (i--) {
      x = kvp[i].split('=');
      if (x[0] === key) {
        x[1] = value;
        kvp[i] = x.join('=');
        break;
      }
    }
    if (i < 0) {
      kvp[kvp.length] = [key, value].join('=');
    }
    return document.location.search = kvp.join('&');
  };

  changeType = function(new_type) {
    var i, url;
    new_type = escape(new_type);
    url = document.location.search.substr(1).split('/');
    i = 0;
    while (i < url.length) {
      if (url[i] === "crm") {
        if (i + 1 === url.length) {
          url.push(new_type);
        } else {
          url[i + 1] = new_type;
        }
        break;
      }
      i++;
    }
    return document.location.search = url.join('/');
  };

  $(function() {
    return $("#change_map").click(function() {
      var url;
      url = window.location.pathname;
      if (url.indexOf("tree_map") !== -1) {
        url = url.replace("tree_map", "map");
      } else {
        url = url.replace("map", "tree_map");
      }
      return window.location.href = url;
    });
  });

  $(function() {
    return $("#census_tract").click(function() {
      return insertParam("granularity", "Census Tract");
    });
  });

  $(function() {
    return $("#block_group").click(function() {
      return insertParam("granularity", "Block Group");
    });
  });

  $(function() {
    return $("#block").click(function() {
      return insertParam("granularity", "Block");
    });
  });

  $(function() {
    return $("#address").click(function() {
      return insertParam("granularity", "Address");
    });
  });

  $(function() {
    return $("#heat_map").click(function() {
      return insertParam("map_type", "heat_map");
    });
  });

  $(function() {
    return $("#markerclusterer").click(function() {
      return insertParam("map_type", "markerclusterer");
    });
  });

  $(function() {
    return $("#circles").click(function() {
      return insertParam("map_type", "circles");
    });
  });

  $(function() {
    return $("#housing").click(function() {
      return changeType("housing");
    });
  });

  ({
    save_filter: function(text) {
      return $.ajaxQueue({
        url: window.location.pathname,
        type: "GET",
        success: function() {
          return console.log("success");
        },
        error: function(data) {
          return alert("Save Failed: " + data.responseText);
        },
        complete: function() {
          return window.location.reload();
        }
      });
    }
  });

}).call(this);
